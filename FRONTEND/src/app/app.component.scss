/* =========================
   Variables & base
   ========================= */
:root{
  --nav-h: 64px;
  --container: clamp(320px, 92vw, 1120px);
  --radius: 16px;

  /* capas */
  --z-nav: 100;
  --z-overlay: 10010;  /* backdrop filtros */
  --z-filters: 10020; /* sheet filtros móvil */
  --z-drawer: 10030;  /* carrito */
  --z-modal: 10040;   /* modal producto */
}

:host{
  display:block;
  min-height:100vh;
  background: linear-gradient(135deg,#fff,#eee,#e5e7eb);
  color:#111;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  overflow-x: hidden; /* sin scroll lateral */
}

:host.dark{
  background: linear-gradient(135deg,#0b0b0b,#0f0f10,#0a0a0a);
  color:#fafafa;
}

/* Util */
.container{
  width: min(100%, var(--container));
  margin: 0 auto;
  padding: 0 16px;
}

/* =========================
   TOP NAV
   ========================= */
.topnav{
  position: sticky;
  top: 0;
  z-index: var(--z-nav);
  backdrop-filter: blur(8px);
  background: rgba(255,255,255,.9);
  border-bottom:1px solid #e5e7eb;
  min-height: var(--nav-h);
}

:host.dark .topnav{
  background: rgba(0,0,0,.55);
  border-color:#222;
}

.nav-bar{
  min-height: var(--nav-h);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 5px;
  flex-wrap: nowrap;
}

.brand{
  display:flex; align-items:center; gap:10px; font-weight:800;
  min-width: 0; /* permite elipsis del texto */
}

.logo-img{
  width:36px; height:36px;
  display:block;
  object-fit: cover;
  aspect-ratio: 1 / 1; /* asegura círculo perfecto */
  border-radius: 50%;   /* <- redondo */
  image-rendering: -webkit-optimize-contrast;
}

.brand-text{
  letter-spacing: .06em;
  font-weight: 900;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-size: clamp(14px, 2.8vw, 18px);
  max-width: 40vw; /* no empuja los botones en móvil */
}

.actions{
  display:flex; align-items:center; gap:8px;
  flex: 0 0 auto;  /* <- no intentes encogerte cortando contenido */
  min-width: 0;
}
.actions button{
  padding:6px 10px;
  border-radius:12px;
  border:1px solid transparent;
  background:transparent;
  color:inherit; font-weight:600; cursor:pointer;
  font-size: clamp(12px, 3.4vw, 16px);
}
.actions button.active{ background:#facc15; color:#000; }
.actions .theme{ background:#e5e7eb; }
:host.dark .actions .theme{ background:#1f2937; }
.actions .cart{ position:relative; background:rgba(250,204,21,.15); }
.badge{
  position:absolute;
  top: 4px; right: 4px;          /* dentro del botón */
  transform: translate(50%, -50%); /* “flotada” a la esquina sin sobresalir */
  font-size:10px; line-height:1;
  background:#facc15; color:#000;
  border-radius:999px; padding:2px 6px; font-weight:800;
  pointer-events: none; /* no captura taps */
}

/* =========================
   HERO (Home)
   ========================= */
.hero{
  min-height:70vh; display:grid; place-items:center; text-align:center;
  padding: 24px 0 16px;
}
.hero h1{ font-size: clamp(40px, 6vw, 72px); font-weight:900; margin:0; }
.hero p{ opacity:.85; max-width:720px; margin:16px auto 0; }
.cta{
  margin-top: 16px;
  padding:12px 20px; border-radius:16px; border:none; background:#facc15; color:#000;
  font-weight:800; cursor:pointer; box-shadow:0 6px 16px rgba(0,0,0,.15);
}

/* =========================
   SHOP: header + layout
   ========================= */
.shop .shop-header{
  display:flex; align-items:flex-end; justify-content:space-between; gap:12px;
  margin-top: 12px;
}
.shop .shop-header h2{ margin:0; font-size: clamp(24px, 3vw, 32px); font-weight:900; }

.right-actions{ display:flex; align-items:center; gap:12px; }
.tags{ display:flex; gap:8px; flex-wrap:wrap; }
.tags span{
  padding:6px 10px; border-radius:12px; background:rgba(250,204,21,.2); color:#a16207; font-size:12px;
}

.shop .filters-toggle{
  display:none; /* visible en móvil */
  padding:8px 12px; border:none; border-radius:12px; cursor:pointer;
  background:#e5e7eb; color:inherit; font-weight:600;
}
:host.dark .shop .filters-toggle{ background:#1f2937; }

.shop-layout{
  display:grid;
  grid-template-columns: 300px 1fr;
  gap:24px;
  margin-top: 16px;
}
.shop { position: relative; z-index: 0; }
/* =========================
   ASIDE filtros
   ========================= */
.filters{
  position: sticky;
  top: calc(var(--nav-h) + 12px);
  height: fit-content;
  background: rgba(255,255,255,.92);
  border-radius: var(--radius);
  box-shadow: 0 10px 30px rgba(0,0,0,.08);
  padding: 14px;
}

:host.dark .filters{ background: rgba(24,24,27,.92); }

.filters-head{
  display:flex; align-items:center; justify-content:space-between; margin-bottom:8px;
}
.filters-head h3{ margin:0; font-size:16px; }
.filters-close{
  display:none; /* solo móvil */
  width:32px; height:32px; border:none; border-radius:999px; cursor:pointer;
  background:rgba(0,0,0,.06); color:inherit;
}
:host.dark .filters-close{ background:rgba(255,255,255,.08); }

.filters-group{
  display:flex; flex-direction:column; gap:8px; margin:12px 0;
}
.filters-group label{ font-weight:700; font-size:12px; opacity:.8; }
.filters-group input[type="search"],
.filters-group input[type="number"]{
  width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(0,0,0,.08);
  background:transparent; color:inherit;
}

.price-row{ display:flex; align-items:center; gap:8px; }
.price-row input{ width:100%; }

.chips{ display:flex; flex-wrap:wrap; gap:8px; }
.chip{
  padding:6px 10px; border-radius:999px; border:1px solid rgba(0,0,0,.1);
  background:transparent; color:inherit; cursor:pointer; font-size:12px;
}
.chip.active{ background:#facc15; color:#000; border-color:#facc15; }

.filters-actions{ display:flex; gap:8px; margin-top:4px; }
.filters-actions .clear{
  padding:8px 12px; border-radius:12px; border:1px solid rgba(0,0,0,.1);
  background:transparent; color:inherit; cursor:pointer;
}
.filters-actions .apply{
  padding:8px 12px; border-radius:12px; border:none; background:#facc15; color:#000; font-weight:800; cursor:pointer;
}

/* Backdrop de filtros: Angular lo añade/quita con *ngIf */
.filters-backdrop{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.45);
  z-index: var(--z-overlay);
}


/* =========================
   CATÁLOGO (centrado)
   ========================= */
.catalog{ width:100%; position: relative; z-index: 0; }
.catalog .grid{
  display:grid; gap:24px;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  max-width: 1100px;
  margin: 0 auto;
  position: relative; z-index: 0;
}

/* Tarjetas */
.card{
  background:rgba(255,255,255,.85);
  border-radius: var(--radius);
  overflow:hidden;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
}
:host.dark .card{ background:rgba(24,24,27,.92); }

/* Media */
.media{
  position:relative; aspect-ratio:4/5; overflow:hidden; cursor:pointer;
  background: #0b0b0b;
}
.card, .media {
  position: relative;
  /* NO usar transform aquí salvo necesidad real; crea stacking context nuevo */
}
.media img{ width:100%; height:100%; object-fit:cover; display:block;position: relative; }
.media .thumbs{
  position:absolute; left:8px; right:8px; bottom:8px; display:flex; gap:6px; overflow-x:auto;
}
.media .thumbs img{
  width:40px; height:40px; object-fit:cover; border-radius:6px; outline:2px solid rgba(255,255,255,.6);
}
:host.dark .media .thumbs img{ outline-color: rgba(0,0,0,.6); }

/* Info */
.info{ display:flex; align-items:center; justify-content:space-between; padding:12px; gap:10px; }
.info h3{ margin:0 0 2px; font-size:15px; line-height:1.2; }
.info .price{ opacity:.85; font-size:14px; margin:0; }
.info .tag{ padding:4px 8px; background:#facc15; color:#000; border-radius:999px; font-size:12px; font-weight:800; }
.info .add{
  padding:6px 10px; border-radius:10px; border:none; background:rgba(250,204,21,.2); color:inherit; cursor:pointer;
}

/* =========================
   ABOUT
   ========================= */
.about{ min-height:70vh; display:grid; place-items:center; text-align:center; padding: 24px 0; }
.about h2{ font-size: clamp(24px, 3vw, 32px); margin:0 0 8px; }
.about p{ max-width: 780px; margin: 0 auto; opacity:.85; }

/* =========================
   MODAL producto
   ========================= */
.modal-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.6); z-index: var(--z-modal); }
.modal{ position:fixed; inset:0; display:grid; place-items:center; padding:16px; z-index: var(--z-modal); }
.modal-body{
  position:relative;
  background:var(--bg,#fff); color:inherit; border-radius:16px; overflow:hidden; max-width:960px; width:100%;
}
:host.dark .modal-body{ --bg:#0b0b0b; }
.close-btn{
  position:absolute; top:10px; right:10px; z-index:2;
  width:36px; height:36px; border:none; border-radius:999px; cursor:pointer;
  background:rgba(0,0,0,.08); color:inherit;
}
:host.dark .close-btn{ background:rgba(255,255,255,.1); }

.viewer{ position:relative; aspect-ratio:4/3; background:#000; }
.viewer img{ width:100%; height:100%; object-fit:contain; display:block; }
.nav{
  position:absolute; top:50%; transform:translateY(-50%);
  width:40px; height:40px; border-radius:999px; background:rgba(0,0,0,.6);
  color:#fff; border:none; cursor:pointer; display:grid; place-items:center;
}
.prev{ left:12px; }
.next{ right:12px; }

.thumbs-lg{
  display:flex; gap:8px; padding:12px; border-bottom:1px solid rgba(0,0,0,.06); overflow-x:auto;
}
:host.dark .thumbs-lg{ border-color: rgba(255,255,255,.08); }
.thumbs-lg button{ border:none; padding:0; border-radius:10px; outline:2px solid transparent; }
.thumbs-lg button.active{ outline-color:#facc15; }
.thumbs-lg img{ width:96px; height:64px; object-fit:cover; display:block; border-radius:10px; }

.meta{ padding:16px; }
.meta .row{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
.meta .price{ font-weight:800; color:#f59e0b; }
.meta .cta{
  padding:10px 14px; border-radius:12px; border:none; background:#facc15; color:#000; font-weight:800; cursor:pointer;
}

/* =========================
   DRAWER carrito
   ========================= */
.drawer{
position: fixed;
  right: 0; top: 0;
  width: min(100vw, 360px);     /* adapta en móvil estrecho */
  height: 100dvh;
  background: var(--bg2,#fff);
  box-shadow: -12px 0 30px rgba(0,0,0,.2);
  z-index: var(--z-drawer);
  display:flex; flex-direction:column;

  /* reemplaza right:-340px -> translateX(100%) */
  transform: translateX(100%);
  transition: transform .25s ease;

  /* un poco de cariño para notch / iOS */
  padding-bottom: env(safe-area-inset-bottom);
}
:host.dark .drawer{ --bg2:#0b0b0b; }
.drawer.open{ transform: translateX(0); }
.drawer header, .drawer footer{ padding:12px; border-bottom:1px solid rgba(0,0,0,.06); }
.drawer footer{ border-bottom:none; border-top:1px solid rgba(0,0,0,.06); }
:host.dark .drawer header,
:host.dark .drawer footer{ border-color: rgba(255,255,255,.08); }

.drawer .content{ padding:12px; overflow:auto; gap:8px; display:flex; flex-direction:column; }
.drawer .item{ display:flex; gap:10px; }
.drawer .item img{ width:64px; height:64px; object-fit:cover; border-radius:8px; }
.drawer .name{ font-weight:600; }
.muted{ opacity:.7; }
.qty{ display:flex; align-items:center; gap:8px; }
.row{ display:flex; align-items:center; justify-content:space-between; }
.row.gap{ gap:10px; }
button[disabled]{ opacity:.5; cursor:not-allowed; }

/* =========================
   Responsive
   ========================= */
@media (max-width: 1200px){
  .catalog .grid{ max-width: 1000px; }
}

@media (max-width: 1024px){
  .shop-layout{ grid-template-columns: 260px 1fr; }
}

@media (max-width: 768px){
  .shop .filters-toggle{ display:inline-flex; }
  .shop-layout{ display:block; }

  /* Hoja lateral fija, aislada y por encima del catálogo */
  .filters{
    position: fixed;
    inset: 0 auto 0 0;                  /* top:0; left:0; bottom:0 */
    width: min(92vw, 380px);
    height: 100dvh; max-height: 100dvh;
    box-sizing: border-box;

    background: rgba(255,255,255,.98);
    color: inherit;
    border-radius: 0 var(--radius) var(--radius) 0;
    box-shadow: 0 20px 50px rgba(0,0,0,.35);

    /* Blindaje de stacking (clave) */
    z-index: var(--z-filters) !important;
    isolation: isolate;
    contain: paint;
    backface-visibility: hidden;

    /* Off-canvas en GPU */
    transform: translate3d(-100%,0,0);
    transition: transform .25s ease;
    will-change: transform;

    overflow-y: auto;
    overscroll-behavior: contain;
    -webkit-overflow-scrolling: touch;

    padding:
      calc(max(12px, env(safe-area-inset-top)) + 4px)
      16px
      calc(max(12px, env(safe-area-inset-bottom)))
      16px;
  }
  :host.dark .filters{ background: rgba(24,24,27,.98); }

  .filters.open{ transform: translate3d(0,0,0); }

  /* Header pegajoso para que el ✕ siempre esté visible */
  .filters-head{
    position: sticky; top: 0;
    background: inherit;
    margin: -4px -16px 8px -16px;
    padding: 8px 16px 10px 16px;
    border-bottom: 1px solid rgba(0,0,0,.06);
    z-index: 1;
  }
  :host.dark .filters-head{ border-color: rgba(255,255,255,.08); }

  .filters-close{
    display: inline-grid; place-items: center;
    width: 36px; height: 36px; border: none; border-radius: 999px;
    background: rgba(0,0,0,.06); color: inherit; cursor: pointer;
  }
  :host.dark .filters-close{ background: rgba(255,255,255,.08); }
}

@media (max-width: 390px){
  .filters{ width: 92vw; }
  .logo-img{ width:32px; height:32px; }
  .brand-text{ font-size: 13px; max-width: 26vw; }
}
